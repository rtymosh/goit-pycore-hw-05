# Завдання 1

# Замикання в програмуванні — це функція, яка зберігає посилання на змінні зі свого лексичного контексту, тобто з області, де вона була оголошена.
# Реалізуйте функцію caching_fibonacci, яка створює та використовує кеш для зберігання й повторного використання вже обчислених значень чисел Фібоначчі.
# Ряд Фібоначчі — це послідовність чисел виду: 0, 1, 1, 2, 3, 5, 8, ..., де кожне наступне число послідовності виходить додаванням двох попередніх членів ряду.

# У загальному вигляді для обчислення n-го члена ряду Фібоначчі потрібно вирахувати вираз:
# F
# n
# =
# F
# n
# −
# 1
# +
# F
# n
# −
# 2
# F
# n
# ​
#  =F
# n−1
# ​
#  +F
# n−2
# ​
#  .

# Це завдання можна розв'язати рекурсивно, викликаючи функцію, що обчислює числа послідовності доти, доки виклик не сягне членів ряду менше n = 1, де послідовність задана.

# Вимоги до завдання:

# Функція caching_fibonacci() повинна повертати внутрішню функцію fibonacci(n).
# fibonacci(n) обчислює n-е число Фібоначчі. Якщо число вже знаходиться в кеші, функція має повертати значення з кешу.
# Якщо число не знаходиться в кеші, функція має обчислити його, зберегти в кеш та повернути результат.
# Використання рекурсії для обчислення чисел Фібоначчі.

# Рекомендації для виконання:

# Як рекомендацію ми надамо псевдокод завдання.

# ☝ Псевдокод — це спосіб запису алгоритму або програмного коду, який використовується для опису ідеї або процесу у вигляді, зрозумілому для людей.
# Він не призначений для безпосереднього виконання на комп'ютері, але допомагає розробникам чітко зрозуміти та спланувати, як буде працювати програма чи алгоритм.
# Його головна мета — передати ідею алгоритму чітко та просто.


# Ось псевдокод для функції caching_fibonacci, яка обчислює числа Фібоначчі з використанням кешування:

# ФУНКЦІЯ caching_fibonacci
#     Створити порожній словник cache

#     ФУНКЦІЯ fibonacci(n)
#         Якщо n <= 0, повернути 0
#         Якщо n == 1, повернути 1
#         Якщо n у cache, повернути cache[n]

#         cache[n] = fibonacci(n - 1) + fibonacci(n - 2)
#         Повернути cache[n]

#     Повернути функцію fibonacci
# КІНЕЦЬ ФУНКЦІЇ caching_fibonacci


# Функція caching_fibonacci створює внутрішню функцію fibonacci і словник cache для зберігання результатів обчислення чисел Фібоначчі.
# Кожного разу, коли викликається fibonacci(n), спочатку перевіряється, чи вже збережено значення для n у cache. Якщо значення є в кеші, воно повертається негайно,
# що значно зменшує кількість рекурсивних викликів. Якщо значення відсутнє в кеші, воно обчислюється рекурсивно та зберігається в cache.
# Функція caching_fibonacci повертає внутрішню функцію fibonacci, яка тепер може бути використана для обчислення чисел Фібоначчі з використанням кешування.


# Критерії оцінювання:

# Коректність реалізації функції fibonacci(n) з урахуванням використання кешу.
# Ефективне використання рекурсії та кешування для оптимізації обчислень.
# Чистота коду, зокрема читабельність і наявність коментарів.


# Приклад використання:

# # Отримуємо функцію fibonacci
# fib = caching_fibonacci()

# # Використовуємо функцію fibonacci для обчислення чисел Фібоначчі
# print(fib(10))  # Виведе 55
# print(fib(15))  # Виведе 610


# У цьому прикладі, коли ви викликаєте fib(10) або fib(15), функція fibonacci всередині caching_fibonacci обчислює відповідні числа Фібоначчі,
# зберігаючи попередні результати в кеші. Це робить повторні виклики для тих самих значень n значно швидшими, оскільки вони просто повертають значення з кешу.
# Замикання дозволяє fibonacci(n) «пам'ятати» стан cache між різними викликами, що є ключовим для кешування результатів обчислень.
from typing import Callable


def caching_fibonacci() -> Callable[[int], int]:
    cache = {}

    def fibonacci(n: int) -> int:
        if n <= 0:  # base case
            return 0
        if n == 1:  # base case
            return 1
        if n in cache: # check if n is already in cache
            return cache[n]
        cache[n] = fibonacci(n - 1) + fibonacci(n - 2)
        return cache[n]

    return fibonacci


# Assign function to variable
fib = caching_fibonacci()

# Use function to calculate Fibonacci numbers
print(fib(10))  # Output 55
print(fib(15))  # Output 610
print(fib(1))  # Output 1
print(fib(0))  # Output 0